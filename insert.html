<html>
<head>
<!-- Include the jQuery Library -->  
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>

<style>
.ans_inp{
		width:100%;
	}
	
</style>

<!-- My jQuery Functions -->
<script>	

$(document).ready(function(){

	$("#save").click(function()
	{
	//alert("Called");
	//Get the attributes
	$question_text = $("#question").val();
	$level = $("#level").val();
	$type = $("#ans_type").val();
	$i=0;
	$options = new Array();
	$correct_ans = new Array();
	do{
	$i = $i - 0 + 1;
	$ans = $("#ans_txt_"+$i).val();
	if($ans != "" && $ans!=undefined ) { $options.push( $ans ); $answer_no = $i; }
	if($("#ans_opt_"+$i).attr('checked') == "checked" ) $correct_ans.push( $i );
	}while($ans!="" && $ans!=undefined);
	$tags=$("#tags").val().split(",");

	//Save in DB
		$.post("CreateData.php", 
		{
		question_text:$question_text,
		level:$level,
		type:$type,
		options:JSON.stringify($options),
		answers:JSON.stringify($correct_ans),
		answers_no:$answer_no,
		tags:JSON.stringify($tags),
		},function(data,status)
				{	
					$("#output").append(JSON.stringify(data));
					//$("#output").append("Over");
					//alert(JSON.stringify(data));
				})

	});

});

</script>

<script type="text/javascript">
// Global Variables
var ans_type=1; //Defaulted to 1
var no_of_ans=2; //No of Answers, defaulted to 2 (Minimum number)
var ans_content="";

function answer_type(type)
{
ans_type = type;
if(type == 0)
	{
	for(i=1;i<=10;i++)
		{
			clear_answer(i); //clear all answers
		}
	no_of_ans = 2;
	return;
	}

var dom;
for(i=1;i<=10;i++)
	{
		dom = document.getElementById("ans_opt_"+i);
		if(type == 2) dom.type = "checkbox";
		else if(type == 1) dom.type = "radio";
		
		if(i<=no_of_ans) document.getElementById("ans"+i).style.visibility = "visible";
	}
	
	
}

function clear_answer(ind)
{
		//alert(ind);
		document.getElementById("ans_opt_"+ind).checked = "";
		document.getElementById("ans_txt_"+ind).value = "";
		document.getElementById("ans"+ind).style.visibility = "hidden";
}

function add_answer()
{
if(ans_type == 0) return;
if(no_of_ans == 10) return;
no_of_ans = no_of_ans - 0 + 1;
document.getElementById("ans"+no_of_ans).style.visibility = "visible";
}

function remove_answer()
{
if(no_of_ans == 2) return;
clear_answer(no_of_ans);
no_of_ans = no_of_ans - 0 - 1;
}

function clear_all_inputs()
{
document.getElementById("question").value = "";
document.getElementById("tags").value = "";
document.getElementById("level").value = "1";
document.getElementById("ans_type").value = "0";
answer_type("0");
}

function handle(e,id)
{
if(e.keyCode == 40 || e.keyCode == 13) //DOWN Arrow pressed OR Enter Key Pressed
	{
	next_id = id.replace("ans_txt_","");
	next_id = next_id - 0 + 1;
	if( document.getElementById("ans"+next_id).style.visibility == "visible" ) document.getElementById("ans_txt_"+next_id).focus( );
	}
else if(e.keyCode == 38)  // UP Arrow pressed
	{
	prev_id = id.replace("ans_txt_","");
	prev_id = prev_id - 0 - 1;
	if( document.getElementById("ans"+prev_id).style.visibility == "visible" ) document.getElementById("ans_txt_"+prev_id).focus( );
	}
}

</script>

<body onLoad="clear_all_inputs();">

<p>

<table cellpadding="10" >
	<tr>
		<td>Question</td><td><textarea id="question" style="border:none; border-style:dotted; border-width:1px; width:350px; height:80px;" value=""></textarea></td>
	</tr>
	
	<tr>
		<td>Tags (Seperated by comma)</td><td><input type="text" id="tags" class="ans_inp" /><td>
	</tr>
	
	<tr>
		<td>Level</td><td> <select id="level">  <option value="1">1 - Easy</option> <option value="2">2 - Medium</option> <option value="3">3 - Hard</option> </select></td>
	</tr>
	
	<tr>
		<td>Answer Type</td><td> <select id="ans_type" onChange="answer_type(this.value);"> <option value="0" selected>-- select --</option> <option value="1">1 - Single Choice</option> <option value="2">2 - Multiple Choice</option></select></td>
	</tr>
	
	<tr>
		<td>Answers<br>
		<img src="images/add.png"  style="width:25px; height:25px; cursor:pointer;" onClick="add_answer();"/>  <img src="images/remove.png" style="width:25px; height:25px; cursor:pointer;" onClick="remove_answer();"/>
		</td>
			<td>
				<table>
					<tr id="ans1" style="visibility:hidden;" ><td>1. <input type='checkbox' name='answers' id='ans_opt_1' /></td> <td><input type='text' id='ans_txt_1' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans2" style="visibility:hidden;"><td>2. <input type='checkbox' name='answers' id='ans_opt_2' /></td> <td><input type='text' id='ans_txt_2' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans3" style="visibility:hidden;"><td>3. <input type='checkbox' name='answers' id='ans_opt_3' /></td> <td><input type='text' id='ans_txt_3' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans4" style="visibility:hidden;"><td>4. <input type='checkbox' name='answers' id='ans_opt_4' /></td> <td><input type='text' id='ans_txt_4' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans5" style="visibility:hidden;"><td>5. <input type='checkbox' name='answers' id='ans_opt_5' /></td> <td><input type='text' id='ans_txt_5' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans6" style="visibility:hidden;"><td>6. <input type='checkbox' name='answers' id='ans_opt_6' /></td> <td><input type='text' id='ans_txt_6' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans7" style="visibility:hidden;" ><td>7. <input type='checkbox' name='answers' id='ans_opt_7' /></td> <td><input type='text' id='ans_txt_7' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans8" style="visibility:hidden;" ><td>8. <input type='checkbox' name='answers' id='ans_opt_8' /></td> <td><input type='text' id='ans_txt_8' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans9" style="visibility:hidden;" ><td>9. <input type='checkbox' name='answers' id='ans_opt_9' /></td> <td><input type='text' id='ans_txt_9' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
					<tr id="ans10" style="visibility:hidden;" ><td>10. <input type='checkbox' name='answers' id='ans_opt_10' /></td> <td><input type='text' id='ans_txt_10' onkeypress="handle(event,this.id);" class='ans_inp' /></td></tr>
				</table>
			</td>
	</tr>
	
	<tr>
		<td><button id="save" >Save</button></td>
	</tr>
	
</table>

<div id="output"></div>
</p>

</body>
	
</head>
</html>